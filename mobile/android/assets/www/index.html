<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <meta name="format-detection" content="telephone=no" />
        <meta name="viewport" content="user-scalable=no, initial-scale=1, maximum-scale=1, minimum-scale=1, width=device-width, height=device-height, target-densitydpi=device-dpi" />
        <link rel="stylesheet" type="text/css" href="css/index.css" />
        <title>Opengram</title>
        <script type="text/javascript" src="cordova-2.7.0.js"></script>
        <script type="text/javascript" src="jquery.js"></script>
        <script type="text/javascript">
        document.addEventListener("deviceready", function(){
            $('#debug').append("Device ready<br />");
        }, false);
        function initialize()Â {
            $('#picture').hide();
            $('#save_picture').hide();
            $('#cancel').hide();
            $('#take_picture').show();
        }   
        function captureImage() {
             navigator.device.capture.captureImage(
                function(files){
                    $('#picture').attr('src', files[0].fullPath);
                    $('#picture').show();
                    $('#save_picture').show();
                    $('#cancel').show();
                    $('#take_picture').hide();
                    $('#debug').append("Image : " + files[0].fullPath + "<br />");
                },
                function(){
                    console.log('Error');
                }, {limit: 1});
        }
        function affichePosition(pos) {
            $('#debug').append('AFFICHE POS : ' + pos.coords.latitude + ' / ' + pos.coords.longitude + '<br />');
            console.log('AFFICHE POS<br />');
        }
        function errorPosition(error) {
            $('#debug').append('ERROR POS<br />');
            console.log('ERROR POS<br />');
        }
        function save_picture() {
            console.log('Image : ' + $('#picture').attr('src'));
            if (navigator.geolocation) {
                $('#debug').append('YESSS<br />');
                navigator.geolocation.getCurrentPosition(affichePosition,errorPosition);
                //setTimeout(function() {
                //    navigator.geolocation.getCurrentPosition(affichePosition,errorPosition);
                //}, 1500);
            }
            else
                $('#debug').append('NOOOO<br />');
        }
        </script>
    </head>
    <body onload="initialize()">
        <div class="app">
            <h1>Opengram</h1>
            <div id="debug">
                DEBUG :<br />
            </div>
            <img id="picture" src="#" width="300" height="300" />
            <button id="take_picture" onclick="captureImage()">Prendre une photo</button>
            <button id="save_picture" onclick="save_picture()">Sauvegarder une photo</button>
            <button id="cancel" onclick="initialize()">Cancel</button>
            </form>
        </div>
    </body>
</html>
